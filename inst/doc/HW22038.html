<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22038" />

<meta name="date" content="2022-11-27" />

<title>HW22038</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">HW22038</h1>
<h4 class="author">22038</h4>
<h4 class="date">2022-11-27</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp22038</strong> is a simple R package developed to
present the homework of statistic computing course by author 22038.</p>
</div>
<div id="hw0" class="section level2">
<h2>HW0</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(iris))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(trees, <span class="fu">symbols</span>(Height, Volume, <span class="at">circles =</span> Girth<span class="sc">/</span><span class="dv">16</span>, <span class="at">inches =</span> <span class="cn">FALSE</span>, <span class="at">bg =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="at">fg =</span> <span class="st">&quot;gray30&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hello world.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Hello world.</code></pre>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
</div>
<div id="section" class="section level2">
<h2>3.3</h2>
<p>The Pareto(a, b) distribution has cdf</p>
<p><span class="math display">\[F(x)=1-(\frac{b}{x})^a,x \geq
b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation
<span class="math inline">\(F^{-1}(U)\)</span> and use the inverse
transform method to simulate a random sample from the Pareto(2, 2)
distribution. Graph the density histogram of the sample with the
Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>First,we derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span>.</p>
<p>Let <span class="math inline">\(y=1-(\frac{b}{x})^a\)</span>,we can
get <span class="math inline">\(x=\frac{b}{(1-y)^{1/a}}\)</span>.So
<span class="math inline">\(F^{-1}(U)=\frac{b}{(1-U)^{1/a}}\)</span>.</p>
<p>Then we use the inverse transform method to simulate a random sample
from the Pareto(2, 2) distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22038</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#parameter a</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#parameter b</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#sample size</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="co">#generate U</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> b<span class="sc">/</span>((<span class="dv">1</span><span class="sc">-</span>U)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a)) <span class="co">#inverse trans</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<pre><code>## [1] 3.527007 2.038548 3.039670 5.728010 2.847378 6.254723</code></pre>
<p>Finally, we graph the density histogram of the sample with the
Pareto(2, 2) density superimposed for comparison.</p>
<p>From the cdf of Pareto(2, 2), we can get the pdf of Pareto(2,
2),which is</p>
<p><span class="math display">\[ f(x)=\frac{a}{b}(\frac{b}{x})^{a+1},x
\geq b&gt;0,a&gt;0 \]</span></p>
<p>In the picyure,the red line is the denisty of our sample,the blue
line is the real pdf of Pareto(2,2). We can see the red line is pretty
close to the blue one, and the more sample we generate, the more closer
they get.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){  <span class="co">#to draw the pdf of P(a,b)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> a<span class="sc">/</span>b <span class="sc">*</span> (b<span class="sc">/</span>x)<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(d)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(b,<span class="dv">50</span>,<span class="fl">0.5</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- as.data.frame(X)</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#p &lt;- ggplot(data, aes(x = X))</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#p + geom_density(color = &quot;red&quot;) + geom_histogram(aes(x = X, y = ..density..),fill = &quot;red&quot;, alpha = 0.2) + geom_line(data =d ,aes(x = x, y = y),col = &quot;blue&quot;)</span></span></code></pre></div>
</div>
<div id="section-1" class="section level2">
<h2>3.7</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>First,write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method.</p>
<p>The pdf of Beta(a,b) is <span class="math inline">\(f(x)=\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1},0&lt;x&lt;1\)</span>.</p>
<p>We use <span class="math inline">\(U(0,1)\)</span> as an envelope
distribution, thus <span class="math inline">\(g(x) =
1,0&lt;x&lt;1\)</span></p>
<p>Then we calculate the <span class="math inline">\(c\)</span>
satisfying <span class="math inline">\(f(x) \leq cg(x)\)</span>.</p>
<p>Let <span class="math inline">\(f&#39;(x)=0\)</span>, we can get the
maximum value of <span class="math inline">\(f(x)\)</span> when <span class="math inline">\(x=\frac{1-a}{2-a-b}\)</span>.($ Beta(1,1)
U(0,1)$)</p>
<p>We choose the maximum value of <span class="math inline">\(f(x)\)</span> as <span class="math inline">\(c\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">##f(x)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">beta</span>(a,b) <span class="sc">*</span> x<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="do">##g(x)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>beta.ar <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  naccepts <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  x.max <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>a)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">-</span>a<span class="sc">-</span>b)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">f</span>(x.max)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(naccepts <span class="sc">&lt;</span> n){</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u <span class="sc">&lt;=</span> <span class="fu">f</span>(y)<span class="sc">/</span>(c<span class="sc">*</span><span class="fu">g</span>(y))){</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>      naccepts <span class="ot">&lt;-</span> naccepts <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>      sample[naccepts] <span class="ot">=</span> y</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sample)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generate a random sample of size 1000 from the Beta(3,2)
distribution.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22038</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">beta.ar</span>(a,b,n)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<pre><code>## [1] 0.6784509 0.5670806 0.8852996 0.4388079 0.3393926 0.8617431</code></pre>
<p>Graph the histogram of the sample with the theoretical Beta(3,2)
density superimposed.In the picture,the red line is the density of our
sample,the blue line is the theoretical pdf of Beta(3,2).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">f</span>(x))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- as.data.frame(X)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#p &lt;- ggplot(data, aes(x = X))</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#p + geom_density(color = &quot;red&quot;) + geom_histogram(aes(x = X, y = ..density..),fill = &quot;red&quot;, alpha = 0.2) + geom_line(data =d ,aes(x = x, y = y),col = &quot;blue&quot;)</span></span></code></pre></div>
</div>
<div id="section-2" class="section level2">
<h2>3.12</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r,\beta)\)</span> distribution and <span class="math inline">\(Y\)</span> has <span class="math inline">\(Exp(\Lambda)\)</span> distribution.That is,<span class="math inline">\((Y| \Lambda=\lambda) \sim f_Y(y| \lambda)=\lambda
e^{-\lambda y}\)</span>.Generate 1000 random observations from this
mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22038</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Gamma <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,r,beta)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,Gamma)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-3" class="section level2">
<h2>3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto
distribution with cdf</p>
<p><span class="math display">\[
F(y)=1-(\frac{\beta}{\beta+y})^r,y\geq0.\]</span></p>
<p>(This is an alternative parameterization of the Pareto cdf given in
Exercise 3.3.) Generate 1000 random observations from the mixture with
<span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>Calculate the theoretical (Pareto) distribution, whcih is</p>
<p><span class="math display">\[f(y)=\frac{r}{\beta+y}(\frac{\beta}{\beta+y})^r,y\geq0\]</span></p>
<p>Compare the empirical and theoretical (Pareto) distributions by
graphing the density histogram of the sample and superimposing the
Pareto density curve.In the picture,the red line is the density of our
sample,the blue line is the theoretical pdf.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">##to draw the pdf of Pareto distribution</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> r<span class="sc">/</span>(beta<span class="sc">+</span>x) <span class="sc">*</span> (beta<span class="sc">/</span>(beta<span class="sc">+</span>x))<span class="sc">^</span>r</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(d)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="fl">0.5</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- as.data.frame(Y) #Use the sample we generate in 3.12</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#p &lt;- ggplot(data, aes(x = Y))</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#p + geom_density(color = &quot;red&quot;) + geom_histogram(aes(x = Y, y = ..density..),fill = &quot;red&quot;, alpha = 0.2) + geom_line(data =d ,aes(x = x, y = y),col = &quot;blue&quot;)</span></span></code></pre></div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>(1)For <span class="math inline">\(n=10^4,2 \times 10^4,4 \times
10^4,6 \times 10^4,8 \times 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,...,n\)</span>.</p>
<p>(2)Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p>
<p>(3)Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n :=nlog(n)\)</span>,and graphically show the
results (scatter plot and regression line).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>(1)(2)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>quickSort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">&lt;=</span><span class="dv">1</span>) <span class="fu">return</span>(x)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  point <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  sv1 <span class="ot">&lt;-</span> t[t<span class="sc">&lt;</span>point]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  sv2 <span class="ot">&lt;-</span> t[t<span class="sc">&gt;=</span>point]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  sv1 <span class="ot">&lt;-</span> <span class="fu">quickSort</span>(sv1)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  sv2 <span class="ot">&lt;-</span> <span class="fu">quickSort</span>(sv2)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(sv1,point,sv2))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10000</span>,<span class="dv">20000</span>,<span class="dv">40000</span>,<span class="dv">60000</span>,<span class="dv">80000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#times for simulations</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> N[i]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  time <span class="ot">&lt;-</span> <span class="fu">numeric</span>(times)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>times) {</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,n,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    time[j] <span class="ot">&lt;-</span> <span class="fu">system.time</span>({<span class="fu">quickSort</span>(a)})[<span class="dv">1</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  an[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(time)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>an</span></code></pre></div>
<pre><code>## [1] 0.0180 0.0341 0.0728 0.1073 0.1481</code></pre>
<p>(3)Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n :=nlog(n)\)</span>:</p>
<p>We use lm() to do the regression.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> N<span class="sc">*</span><span class="fu">log</span>(N)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>myfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(tn <span class="sc">~</span> an)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>myfit</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = tn ~ an)
## 
## Coefficients:
## (Intercept)           an  
##      -19722      6247586</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(an,tn)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(myfit,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see the regression is reasonable bucause the dots are close to
the red line.</p>
</div>
<div id="section-4" class="section level2">
<h2>5.6</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of</p>
<p><span class="math display">\[\theta = \int_0^1 e^x dx\]</span></p>
<p>Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>,where <span class="math inline">\(U \sim Uniform(0,1)\)</span>.What is the percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and
<span class="math inline">\(Var(e^U+e^{1-U})\)</span>,where <span class="math inline">\(U \sim Uniform(0,1)\)</span>:</p>
<p><span class="math display">\[Cov(e^U,e^{1-U})=E[e^U
e^{1-U}]-E[e^U]E[e^{1-U}]\]</span></p>
<p><span class="math display">\[E[e^U e^{1-U}]=\int^1_0 e^x e^{1-x}
dx=e\]</span></p>
<p><span class="math display">\[E[e^U]=E[e^{1-U}]=\int^1_0
e^xdx=e-1\]</span></p>
<p>So<span class="math display">\[Cov(e^U,e^{1-U})=e-(e-1)^2\]</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>e<span class="sc">-</span>(e<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] -0.2342106</code></pre>
<p><span class="math display">\[Var(e^U+e^{1-U})=Var(e^U)+2Cov(e^U,e^{1-U})+Var(e^{1-U})\]</span></p>
<p><span class="math display">\[Var(e^U)=Var(e^{1-U})=E[e^{2U}]-(E[e^U])^2=\frac{1}{2}(e^2-1)-(e-1)^2
\]</span></p>
<p>So<span class="math display">\[Var(e^U+e^{1-U})=-5+10e-3e^2\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">5</span><span class="sc">+</span><span class="dv">10</span><span class="sc">*</span>e<span class="dv">-3</span><span class="sc">*</span>e<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.01564999</code></pre>
<p>the percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)</p>
<p><span class="math display">\[p=
\frac{Var(e^U)-Var(e^U+e^{1-U})/4}{Var(e^U)}=\frac{\frac{1}{2}(e^2-1)-(e-1)^2-(-5+10e-3e^2)/4}{\frac{1}{2}(e^2-1)-(e-1)^2}=\frac{(-1-2e+e^2)/4}{(-3+4e-e^2)/2}=\frac{-1-2e+e^2}{2(-3+4e-e^2)}
\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span>(<span class="sc">-</span><span class="dv">1-2</span><span class="sc">*</span>e<span class="sc">+</span>e<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>e<span class="sc">-</span>e<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.983835</code></pre>
</div>
<div id="section-5" class="section level2">
<h2>5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(U)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(T1,T2) <span class="co">#the theoretical value is -0.2342106</span></span></code></pre></div>
<pre><code>## [1] -0.2347258</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(T1<span class="sc">+</span>T2) <span class="co">#the theoretical value is 0.01564999</span></span></code></pre></div>
<pre><code>## [1] 0.01573709</code></pre>
<p>the antithetic variate estimator is</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(T1<span class="sc">+</span>T2)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n)</span></code></pre></div>
<pre><code>## [1] 1.718431</code></pre>
<p>the simple estimator is</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(T1)<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 1.718873</code></pre>
<p>the percent reduction in variance using the antithetic variate is</p>
<p><span class="math display">\[p=\frac{Var(\theta_1)-Var(\theta_2)}{Var(\theta_1)}\]</span></p>
<p>which <span class="math inline">\(\theta_1\)</span> is the simple
estimator,<span class="math inline">\(\theta_2\)</span> is the
antithetic variate estimator.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(T1)<span class="sc">-</span><span class="fu">var</span>(T1<span class="sc">+</span>T2)<span class="sc">/</span><span class="dv">4</span>)<span class="sc">/</span><span class="fu">var</span>(T1)</span></code></pre></div>
<pre><code>## [1] 0.9837743</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the theoretical value is 0.983835</span></span></code></pre></div>
<p>We can see the result is pretty close to the theoretical value.</p>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
</div>
<div id="section-6" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to</p>
<p><span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating</p>
<p><span class="math display">\[\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span></p>
<p>by importance sampling? Explain.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math inline">\(f_1(x)=xe^{-x^2/2},x&gt;0\)</span>,which is the
pdf of <span class="math inline">\(Weibull(2,\sqrt{2})\)</span></p>
<p><span class="math inline">\(\frac{g(x)}{f_1(x)}=\frac{1}{\sqrt{2\pi}}\)</span></p>
<p>Let <span class="math inline">\(f_2(x)=4x^2e^{-2x},x&gt;0\)</span>,which is the
pdf of <span class="math inline">\(Gamma(3,2)\)</span>.</p>
<p><span class="math inline">\(\frac{g(x)}{f_2(x)}=\frac{1}{4\sqrt{2\pi}}e^{2x-x^2/2}\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>est<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#f1</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rweibull</span>(n,<span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>gf<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dweibull</span>(x,<span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(gf)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(gf)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">#f2</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rgamma</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>gf<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(gf)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(gf)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>est</span></code></pre></div>
<pre><code>## [1] 0.3988194 0.4093884</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sd</span></code></pre></div>
<pre><code>## [1] 0.3625265 0.3004796</code></pre>
<p>We can see <span class="math inline">\(f_2\)</span> produces smaller
variance.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">dweibull</span>(t,<span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">dgamma</span>(t,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,g,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">main=</span><span class="st">&quot;compare g(t), f1(t) and f2(t) &quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))   </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,f1,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)  </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,f2,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span><span class="fu">c</span>(<span class="st">&#39;g(t)&#39;</span>,<span class="st">&#39;f1(t)&#39;</span>,<span class="st">&quot;f2(t)&quot;</span>) ,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then,we draw the ration functions and make comparision,which are
<span class="math inline">\(\frac{g(x)}{f_1(x)}\)</span> and <span class="math inline">\(\frac{g(x)}{f_2(x)}\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">dweibull</span>(t,<span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">dgamma</span>(t,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>r1<span class="ot">&lt;-</span>g<span class="sc">/</span>f1</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>r2<span class="ot">&lt;-</span>g<span class="sc">/</span>f2</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,r1,<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,r2,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;ratio function&quot;</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span><span class="fu">c</span>(<span class="st">&#39;g/f1(t)&#39;</span>,<span class="st">&quot;g/f2(t)&quot;</span>) ,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see the curve of <span class="math inline">\(\frac{g(x)}{f_2(x)}\)</span> is more “close” to
constant while <span class="math inline">\(\frac{g(x)}{f_2(x)}\)</span>
is getting bigger when t increases, whcih means <span class="math inline">\(f_2(x)\)</span> is more “close” to <span class="math inline">\(g(x)\)</span>.So <span class="math inline">\(f_2(x)\)</span> produces smaller variance.</p>
</div>
<div id="section-7" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<p>There is something wrong with the subintervals in Exercise 5.15
(Example 5.13). You may modify it without losing the original
intent.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>First, we should make some correction for the density function. On
the <span class="math inline">\(j^{th}\)</span> subinterval, variables
are generated from density function <span class="math display">\[f_j(x)=\frac{e^{-x}}{e^{-(j-1)/5} - e^{-j/5}}, x
\in [\frac{j-1}{5}, \frac{j}{5}].\]</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>T5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">#use reverse transform method</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x,a,b) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span>a)<span class="sc">*</span>(x<span class="sc">&lt;</span>b)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="cf">function</span>(u,a,b) <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a)<span class="sc">-</span>u<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>a)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>b)))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="cf">function</span>(x,a,b) <span class="fu">g</span>(x,a,b)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>a)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>b)))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(M)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  u.s<span class="ot">&lt;-</span><span class="fu">runif</span>(M<span class="sc">/</span>k)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#importance sampling</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">fg</span>(<span class="fu">h</span>(u,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#stratified importance sampling</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) T5[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">fg</span>(<span class="fu">h</span>(u.s,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k),(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k))</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(T5)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(est,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5249449 0.5248763</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(est,<span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## [1] 0.001162856 0.000401359</code></pre>
<p>The simulation indicates that the of variance of the eatiamtor is
smaller by using stratified importance sampling.</p>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
</div>
<div id="section-8" class="section level2">
<h2>6.4</h2>
<p>Suppose that <span class="math inline">\(X_1, . . . , X_n\)</span>
are a random sample from a from a lognormal distribution with unknown
parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>lognormal distribution:</p>
<p>If <span class="math inline">\(X\)</span> is from a lognormal
distribution,then <span class="math inline">\(Y=lnX \sim
N(\mu,\sigma^2)\)</span></p>
<p>the estimate of <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math inline">\(\hat{\mu}=\bar{Y}=\sum_{i=1}^n
Yi/n\)</span></p>
<p>Also,<span class="math inline">\(S^2=\frac{1}{n-1}\sum_{i=1}^n(Y_i-\hat{\mu})^2\)</span></p>
<p><span class="math inline">\(\frac{\sqrt n (\hat{\mu}-\mu)}{S}\sim
t_{n-1}\)</span></p>
<p>So the 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is:<span class="math inline">\((\hat{\mu}-\frac{S}{\sqrt
n}t_{n-1}(0.975),\hat{\mu}+\frac{S}{\sqrt n}t_{n-1}(0.975))\)</span></p>
<p>Obtain an empirical estimate of the confidence level:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n,<span class="at">expr=</span>{</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n,mu,sigma<span class="sc">^</span><span class="dv">2</span>) <span class="co">#produce sample from lognormal distribution</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">log</span>(x) <span class="co">#let Y=lnX,Y~normal distribution</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(<span class="fu">sqrt</span>(n<span class="sc">/</span><span class="fu">var</span>(y))<span class="sc">*</span>(mu<span class="sc">-</span><span class="fu">mean</span>(y)))<span class="sc">&lt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tests)</span></code></pre></div>
<pre><code>## [1] 0.951</code></pre>
</div>
<div id="section-9" class="section level2">
<h2>6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} = 0.055\)</span>. Compare the power
of the Count Five test and F test for small, medium, and large sample
sizes. (Recall that the F test is not applicable for non-normal
distributions.)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>Ftest <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  Fp <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x, y)<span class="sc">$</span>p.value</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(Fp <span class="sc">&lt;=</span> alpha.hat))</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>alpha.hat <span class="ot">&lt;-</span> <span class="fl">0.055</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(n), <span class="dv">2</span>)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  tests <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i], mu1, sigma1)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i], mu2, sigma2)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">count5test</span>(x, y), <span class="fu">Ftest</span>(x, y))</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  result[i, ] <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(tests)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result,<span class="at">row.names =</span> n)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Count Five test&quot;</span>,<span class="st">&quot;F test&quot;</span>)</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##      Count Five test F test
## 10            0.1061 0.2139
## 20            0.3084 0.4193
## 50            0.6531 0.8147
## 100           0.8504 0.9793
## 500           0.9894 1.0000
## 1000          0.9973 1.0000</code></pre>
<p>We can see F test performs better than Count Five Test.But F test is
not applicable for non-normal distributions.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
<p>• What is the corresponding hypothesis test problem?</p>
<p>• Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>• Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The corresponding hypothesis test problem is</p>
<p>$H_0:power_1=power_2 H_1:power_1power_2 $</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Z-test:Z-test is a statistical hypothesis testing technique which is
used to test the null hypothesis in relation to the following given that
the population’s standard deviation is known and the data belongs to
normal distribution.When the sample size is large, we have the mean
value of significance test follows a normal distribution, thus this
method can be used.</p>
<p>paired-t test:You can use the test when your data values are paired
measurements. For example, you might have before-and-after measurements
for a group of people. Also, the distribution of differences between the
paired measurements should be normally distributed.When the sample size
is large, we have the mean value of significance test follows a normal
distribution, so this method can be used.</p>
<p>two-sample t-test:You can use the test when your data values are
independent, are randomly sampled from two normal populations and the
two independent groups have equal variances.As the p-value of two
methods for the same sample is not independent, we can not apply the
two-sample t-test.</p>
<p>McNemar test: For this test, your variable of interest must be
proportional or categorical. In this question, our variable is
categorical, so this method can be used. And it is good at dealing with
unknown distribution.</p>
<p>(3)For these test, what we already know is the number of experiments
and the value of power(the probability that we reject the null
hypothesis correctly). To conduct this test, we also need to know the
significance of both methods for each sample.</p>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
</div>
<div id="section-10" class="section level2">
<h2>7.4</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
air-conditioning equipment [63, Example 1.1]:</p>
<p><span class="math display">\[3, 5, 7, 18, 43, 85, 91, 98, 100, 130,
230, 487.\]</span></p>
<p>Assume that the times between failures follow an exponential model
Exp(<span class="math inline">\(\lambda\)</span>). Obtain the MLE of the
hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>Obtain the MLE of the hazard rate <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[L(\lambda,x_1,..,x_n)=\lambda
^ne^{-\lambda\sum x_i}\]</span></p>
<p><span class="math display">\[l(\lambda,x_1,..,x_n)=lnL(\lambda,x_1,..,x_n)=nln\lambda-\lambda\sum
x_i\]</span></p>
<p><span class="math display">\[\frac{\partial l}{\partial
\lambda}=\frac{n}{\lambda}-\sum x_i=0\]</span></p>
<p>So,<span class="math display">\[\hat\lambda=\frac{n}{\sum
x_i}\]</span> is the MLE of <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<p>use bootstrap to estimate the bias and standard error of the
estimate:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>lambdastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  lambdastar[b] <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="fu">sum</span>(xstar) </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda,<span class="at">se.boot=</span><span class="fu">sd</span>(lambdastar)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    bias se.boot 
##   0.001   0.004</code></pre>
</div>
<div id="section-11" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>meantime.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x[i])</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> meantime.boot, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.6, 181.8 )   ( 22.9, 169.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.1, 193.3 )   ( 57.2, 230.9 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>Different methods use different ideas to get the CI.</p>
<p>The standard normal bootstrap confidence interval suggested that when
the sample size is large, then the Central Limit Theorem implies that
<span class="math inline">\(Z=\frac{\hat\theta-E[\hat\theta]}{se(\hat\theta)}\)</span>is
approximately standard normal.</p>
<p>The basic bootstrap confidence interval transforms the distribution
of the replicates by subtracting the observed statistic. The quantiles
of the transformed sample are used to determine the confidence
limits.</p>
<p>A bootstrap percentile interval uses the empirical distribution of
the bootstrap replicates as the reference distribution.</p>
<p>BCa modified the percentile intervals.For a <span class="math inline">\(100(1 − \alpha)%\)</span> confidence interval, the
usual <span class="math inline">\(\alpha/2\)</span> and <span class="math inline">\(1 − \alpha/2\)</span> quantiles are adjusted by
two factors: a correction for bias and a correction for skewness.</p>
</div>
<div id="a" class="section level2">
<h2>7.A</h2>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the porportion of times that the confidence
intervals miss on the right.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>) </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i]) </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>) </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  R<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,mu) <span class="co">#sample from a normal population</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>R,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>) </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="co">#the standard normal bootstrap CI</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#the basic bootstrap CI</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#the percentile CI</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39; norm :&#39;</span>,<span class="st">&#39;left=&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&#39;right=&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic :&#39;</span>,<span class="st">&#39;left=&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&#39;right=&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc :&#39;</span>,<span class="st">&#39;left=&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&#39;right=&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span></code></pre></div>
<pre><code>##  norm : left= 0.047 right= 0.049 
##  basic : left= 0.053 right= 0.047 
##  perc : left= 0.049 right= 0.049</code></pre>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
</div>
<div id="section-12" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> bootstrap<span class="sc">::</span>scor</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(data)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(data[<span class="sc">-</span>i,])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="section-13" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag </span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>,<span class="at">nrow =</span> n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(i,j)] </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i]</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    e1[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> yhat1</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j] </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    e1[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> magnetic[j] <span class="sc">-</span> yhat1</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    e2[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> yhat2</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[j]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    e2[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> magnetic[j] <span class="sc">-</span> yhat2</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x) </span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i]</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3) </span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>    e3[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> yhat3</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j]</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3) </span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>    e3[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> magnetic[j] <span class="sc">-</span> yhat3</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[i]) </span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>    e4[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> yhat4</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[j]) </span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    e4[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> magnetic[j] <span class="sc">-</span> yhat4</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic
model, would be the best fit for the data,which gives the same result as
leave-one-out (n-fold) cross validation.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
</div>
<div id="section-14" class="section level2">
<h2>8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(x)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1,y1,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.679</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y)<span class="sc">$</span>statistic</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x1,y1)<span class="sc">$</span>statistic</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.67</code></pre>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
</div>
<div id="section-15" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>lap_f <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">=</span> <span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x0</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">lap_f</span>(y) <span class="sc">/</span> <span class="fu">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] <span class="ot">=</span> y </span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">=</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">k =</span> k))</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="dv">25</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the acceptance rates</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>Rej <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k),<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>Acc <span class="ot">=</span> <span class="fu">round</span>((N<span class="sc">-</span>Rej)<span class="sc">/</span>N,<span class="dv">4</span>)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Acc) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;acceptance rate&quot;</span>)</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Acc) <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Acc)</span></code></pre></div>
<pre><code>##                 sigma= 0.05 sigma= 0.5 sigma= 2 sigma= 16
## acceptance rate       0.988      0.844    0.526    0.1055</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))  #display 4 graphs together</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">=</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,  rw4<span class="sc">$</span>x)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb2//b////tmb/25D//7b//9v///8ibl+/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIx0lEQVR4nO2da3vbJhiG6Zp0p2Rb19Tb6q12wv//j5OFQMgcHoReych57g+9fIAXdAcQSMhVmmRRt65A61AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIICwILUbbiVINtx6UBCAggD3LEikjLsWJFEIBaEg4glvEi5ehhIoiIJQEPGE+Siz51+LCtO7E7RWuHgZSi8fiCgIBRFPeJNw8TIucpb2s7sWpO1oR0HREigIlDAVVFniHQtSZhSioFQJU0G1Z7P7FqSNIEVBkQLcLEhRULSAUVDf0SjougBli3m/gtLHrPwClq2PWxM0p5jkIU913Jmg0nKUPUVFg0wF6bsQZD4pF5RpFlFBlUfQjKDhkCQEXX+xJ0HJK4pu1SQiaBrGm1JX1Fg8YV24akGR9JFp4b0IKh5Kx17zrgSVn2vMtQzbecLYUUFVh7CSoLcXc7Q/fCsLp6QFxXI0JOionsyLk30BwrkOVnYUamwRYZ5UiLqZ0CqC3l6cluPH7yXhlB1WyoaKKkF1TWgVQa/PX+zLU6KTRQUVj6VGyn4FzW5B49K7rCDPSbBSz/SkZgR1Y9DQhArHoAWC9C4FdZ3MjLiJ9nMVTi0RFLzLZCsIXZ1nzXnQ1coJlxcMO96L+xJkVhdTQQUN6Y4EHfNnsTpBwaTPvlP7EwTC+bc/7TclgqKDvA7W8fFCayoqmHBWuMj6okzQ1QcUlK+LL2hOvgJWmklfZj8nvFiNrVDdCmJOXdQYL1Ov8nlErqylCfUgqJ9De4sOE2WqREWuQ9gLZ1WC8ssJ5SUtZTVBgxq01AhXX8rdDY3kSbWBQkEqaj4/o8h9WZVQG0Hnx14QWqyGJ+akIJURpOcLGhPeRlBhC4qcsjUQFO19Q8dEgsaF29V9oXSeTLy6hNquxB60Ha5z4SJTOxVMHrU99qwgVSBINSFI944+fE0v5ieCIt+Fd27GTSxZQXlSgjJaFwj6O3UKnxXuxoKGJikm6PWzfX9+TM5xysPFK6D8arvR180I4lWuE6TEBT13HefCIT0HvHDsyjSDdNkl16vvbLW985a9qJ/MWiJI+4Jsi5TtYm8vl8H3/NgPwUmOncbX50uSKkGu2ranKXc4WUH4YMYmNAqynlJhC3EJT+rDH2poRwnMNem3l+4UXy/IX6d5gpLNBCwzbKJJ9PHMmM4BYwYJTSPKYRcYh4/f2xOk9cqCjpcWlB+g3V2Nw8MCQTouKKVhhiA7p5wISvbcQoaE3fzmof83NcHpsVq6dAsEjYaUnV8LCzKtSAsKKj+LmU729lIhaLy8M/ydPUHpZX6tICUrSHwelPvWTVXsMeROONkFg5dI23BTQUnvMGYyocxMGiYqFlRerB2WvRaZbpglYWcllA7nzQ0z08RZFRzH/uYEKb9dl5cs/ddpV1BNuKLBZV7h49DshiUKmkQMfCQb9S4EzemQpREDQamrBMVBF1VpUThpP1qFPYqCrgoPBKWq9C4FRWJSEIhJQbh8FX39XgXFirl6rYJPi7ML12bjokuKoSBQDAWBYsaJAAXFilEUlC/G3W/ah6CNmApSFHSNN5ugoBi+IH0rQTVXFLfiWpB9WZpduDay4UQYDXk3OShoZJSytqDifdJtsbGg6D7pqnBb4UtZX1DpLteG2FZQ4T7plmALQtidHhsIusx0yvZJt4TbyLC2ID1jn3RLuN1aXv04D/IY79hTUBQ17mbYTFDNHsWb4QkaPyvOLFwX2XBCUBAgskOLgnw2FtStVpM78hsVpINNHisJOij1dP75O3qotzU2E3ToFhiHvvXsaqmxmaC+3Zw/XQTtabG6paD+aZ//9N5akN6qi7np4b4WqzqYBa02SB/N6eukEhcUGxZ0/UFxTuGKyIYTg4IQGwla9FDvTdlG0LKHem/KJoIWPtTbFOtNFHX1Q71NsWIL0rUP9TbFuhPFuod6m2K1sxh6qHc3rCNIOGhhupskq0wuG5SCZNJRUIvJKpPLBqUgmXQU1GKyyuSyQSlIJt39CbonKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEEBeUG4TrP/EkEuXz5Dj/OM36ZAB4oJOl6eB0rUzWxz9dCBDhtfn/u6cZMgQaUHm9vQh+dPddvenS4cypDkNDxcLhowgLcg8spm6dd9983CVDmVIclJPRo1cyBjigrK7hLu/60/dePHkpUMZcphcoiEDpAWZrp8cAF6fL/uHD09jOpAhX9jFgWzIgI0FDYl++CYnSDZkwNZdzCR6/CLYxURDBmw9SJtEn76KjKi+IKGQARuf5k3duwMTOSf3gmRDBmw9Ueyr3Y2oIrO64SwmGTJAfqlxzE/zD8putbbpQIYMQxeTDBnAxSqAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBNiBoMmeXvtm3Pu7Mu0LmmzVcG/c3t+1aV7QZLPP+EZo/ximeUGT7WLjm+MGvaunFUFvfz32PwwV/EbsZMPh+Mbu/V2dVgQdPv6jz58jPzE82bLq3ri9v6vTiKChafxq3h2G3xnrH1CJCjLpthiIGhFkDvX1t/DUlOhi5rvH1K8Sy9GWoMj/65YYpM13G5zrGxFk1NgW4Xex+Gne7f1dvWaNCOrGlT/Nr8RGvolNFN3e37VpRZD+93elfon+UP6wp/ft5UF7G3zd3t+VaUZQq1AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/AY2l4yqZrOR0AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8ZM4qDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHv0lEQVR4nO2djXqjKBiF6bSZ/Wl2Z7ZtdnfcSVLu/yZXRRQEOZCgYjzvPJMm8eND3iJiQ62QJIhYewdKh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIEXQ9fhaP56FEF9+zLU/xZEsqHr+2Tx7m22PCiNVUKem1bQLUgVdDq2g824Ossw9SGyGeQQ1mV+kHq7vTLcqswiSraOnj/pENuGHghZONx8LCxod2hvQNJOgqlagBumJs9jOBVX1+HM9NqM0Bfn4fH9tH+tTfFjQBgzNdJpXFxin558U5EP1oJrTCwV50Vrq2RAFeanUOazuSxR0V70UBNJREEhHQSAdBYF0FATSURBIR0EgHQWBdBQ0zjL6WTgFgXQUBNJREEhHQSAdBYF0FATSURBIF//R91pQEGCmTzXgCjMKAivMKAitD+q+7FcQWGFGQexBARJWmO1TkIxfYbZbQbHpKGiUZbx4lIJAOgoC6fYpSJ3FFOF50E4FTa96cdLtVFBt6CUu3V4F1TOg8O9B7V5QdLrSDVEQgIIAFASgIAAFAe4Q9M89v436qIKu3/Xry+GuX9d9WEHHp4/2yenOewY8qqD6GqL5UerlIMClRHS9jyaouYh4+ia6fpRenfPb1o8nqOtEuep9PEFV04Puvp/Cwwq6HpvuUz9OfVyRWu+DCeJZDARyHpQQyJn0bYGJ6SgIpKMgkI6CQDoKAukoCKSjIJBOFO5ops/mY5cB71lQ1DLg5knZ6xRnExS3iHPHgvzLgH0/MFtbULj6HfeguPUTMwmKv9FkI2h+Q74aVhQkE240Kdp/c1OeoOh0FATSNQcYzn3vbnpkRK5EXl2QTBAUsQ97EDR9OFhb/B+t2QO+E+IRZJbwVF24IGH8H12W5BMk3Hj/3gRZXJCQXSMyCOpvrmsW9wlyZxwFCRLdAxQ0bqwtaNwBzXeF6KuxBI3jzN1Lb1EWHEHCEqTfdAUJryAhuyn5SFAvRm+NESSKFSQsQUILElqfGDbocipAYEHCkCSkfikGeV2U7CMS2z2voO6f3vORIL3DeoNu2NBE69EaU7TBPhwJEiUKMvY9LEi4gozWmoL6bNIWNHzxCzI7W1K7lxEkjNYPPd4UYQky3zBDpCUtKGiUwZJUmqBRk30vfO1w35Zmb5DjrVNsSFCMkGBTZaRVa5tTZg1B4+p7QfGNj4lxO0NyRlnYGDTaTdChQHvdpMYT5z3pTZfc7tkE6fNqcODRO61POwFD5kjsF9TXqW16sqW3ewlBfdsmBMhuKiTsA1Ma6kaCzBOk1LmlNfO2BPW9Kr3d8wmSsp9E6/mPR9BQRO+/R5DRuyxB0iOoe9Tzzy5Q209v96yCpCPIuHQwOo/aYDwRfYN6r9qgIcgKNqofsnYHX8GC5PD9RILMEkPf8gnqH/t8tqDhmQ4uWlD3ttUg2esJCWqfi/7RFmSl9uWQRsHiBVkRw3gSCLGPmoCgiWq3K2hobZwgq4jxPLJaoROOwkoWpALTBWkrSYKsBCklkgNl2vogWG+aoK5M/yJVkO/0GkeyoMj1QbheIMiTdhOCYld3RNR7j6DkahcTFHebwKh6Q4K8G4X15T620IOC2zYqqBk88/wh2lsEpdZxa/331DaxPsi8+Jyl3kxFb0iy1jxobeYU1P+pwzzp1oGCABQEWE3QZlhJUFrSyLhVwm4Mz5uUgvLEUVCJYTeG501KQXniKKjEsBvD8yaloDxxjyfokaAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA/ILOInRb6mEBRB8XLhDi8suP3Ckdsgs6N4sbpvfu8vVjFAcKBLge21VKOVO65BakPjQ7Td66W6+86uNQgWnO3VrJjCk95BakVqBVk6s8q5dRHCowyVm8KjX5UvrILqjt71Mr9Orv66/1ePFqxKECIVSprCkdcgtSh/7kAHA9Nmv3Tq9DHCgQrqxxkDelw8KCuqAvP/IJypvSYelDTAUd3jIeYllTOiw9SKugrx9ZRlRTUKaUDguf5tW+1w3Lck5uBeVN6bD0RLHd7XpEzTKr685iOVM65L/UqERwmn+qz8lvVhwoEKA7xHKmdODFKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE2JSgz3e12G5JtiTo8/3pQ1Yiz7KWWLYkKOvCqFi2JEiRa+FPJAUK+vz70N4jamKwOe2+B52e/5WX7/47fcrA33idh/IEdWtUf1evTt0tx/TIfF54jC5QkFpXd/3DO9Is3X8KFuS9Y3W1uJ8CBSk13W2Z7UOsEhP3+Z6R8gTV5/G/6jmh537Ml8Pi/adIQfK/P4X4zXMWq1Rn2v08qCwoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA/ztPN6ea3SjEAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the first plot of Figure 9.3 with <span class="math inline">\(\sigma = 0.05\)</span>, the ratios <span class="math inline">\(r(X_t,Y )\)</span> tend to be large and almost
every candidate point is accepted. The increments are small and the
chain is almost like a true random walk. Chain 1 has not converged to
the target in 2000 iterations. The chain in the second plot generated
with <span class="math inline">\(\sigma = 0.5\)</span> is converging
very slowly and requires a much longer burn-in period. In the third plot
(<span class="math inline">\(\sigma = 2\)</span>) the chain is mixing
well and converging to the target distribution after a short burn-in
period of about 200. Finally, in the fourth plot, where <span class="math inline">\(\sigma = 16\)</span>, the ratios <span class="math inline">\(r(X_t,Y )\)</span> are smaller and most of the
candidate points are rejected. The fourth chain converges, but it is
inefficient.</p>
<p>for <span class="math inline">\(\sigma=0.05\)</span>:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j]) </span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W  <span class="co">#G-R statistic</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fl">0.05</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate </span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#burn-in length</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values </span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma,x0[i],n)<span class="sc">$</span>x</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics </span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum)) </span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) </span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j]) </span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmtv+QOgCQ2/+2ZgC2///bkDrbkJDb////tmb/25D//7b//9v///8ii+Y3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFBklEQVR4nO3da3eaShhAYZqmba7GliT+/39aBXOTwJ4xTHh19v5yWOs4gz5rBFJvzcYma5a+A9ETCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCJoZqDmZlgKad7pyCQQJBC0LdAJMC6+g+EICQQJBAkFLA4UXWvo0H15oaaDwQosDRT8MCQR9M9AnfyQLBNMJBNMJBNMFP40tDxR8CQkECQQJBAkECQQJBAkERQAKLRQAKPYSEggSCBIIEggSCBIICgEUWSgCUOglJBC0/Ms+s81dJlcQJBAkECQQJBAkEFQI6PmuP5lfPKRMF/lSugzQurnuN9qXjenpagN6vntlWf/8lzBdbUBPN7cvm+3Ik6xuIFcQtW72S6jqY9DfsTPUZvck689iI+vnnIHW+3P3893oKTx/v2cE1P6436y266Jtxp48x+z3fICe7y67k9S62UJNlHeheEZATzfXu0d/1VxO3jj7QjGuUDbQ7vS0gqdX9mk+8BI6Dmj05LR5d6uutAvFswOafoK5gggo+0KxOqDcC8VzAnp74WbGC8XzAfry7ka+M6Q6oMwLxeqAci8UawM64jQfVijGvygGXkJBVlBlQPkXirUBZV8oVgeUPZ1AMJ1AMJ1AMF3YC6FC10H4J+1guqqAEl4Tqhyof/Uja7rKgLZXiLeT/796oOzpBILpop7GwgBFXUICQQJBAkGBgGIKBXnZZ749zF2cFSQQTScQTRdSSCAoFFBEoUhAIZeQQFAsoIBCoYAiLqFgQPGEYgEFFAoGFE8oGlA4oXBA0YTiAQUTCgi0yfhhwfJFBApFFBMoEFFUoP2/zs6702OKC9TdanmkYu/uyPsowtSOM38QdubKAGV/FCFh/0f+gO5XKwJ0xBvJcxv95eEZy7ujOY9o/KMIg3sQ/78lgL5hBX1bpY5BuR9FCFuhs1j2RxHCtth10Mm0ENBXJo05SqAi8xeZNOYogYrMX2TSmKMEKjJ/kUljjhKoyPxFJo056mT+NlgqgSCBIIEggSCBIIEggSCBIIEggSCBIIGg+YHaBr7WfF//Gtvl+xHDjYMe/zx8fjsceXSzA+2+Hb9NuY+Pv+8PRgw3Dnq66d4SMDEgee/JzQ3Uv37P3yv89v6H1xHDjcMR/RuTJgak7z25uYEef+1evl8nfKXw+vJgxHDj44C2ue5QJwak7z252YG6J87YF3W+b3XVdL9R8TpiuDEY0wOND0jfe3JzA/UHgITDwNPN7h0Qq+u3EcON4ey7hz4xIHnv6S0GtL/5xUNlQJmLfHvQqOwplnmY3D6inEPtGRykk0+0/WPZPuKck3V7+qf59Eu17mFsD9I5l3vt6V8odj/ElXYPV9vT/O2HEcONg/ZHl4kByXtPzT9WIYEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaD/pleUIdASssAAAAAASUVORK5CYII=" /><!-- --></p>
<p>Chain 1 has not converged to the target in 15000 iterations.</p>
<p>for <span class="math inline">\(\sigma = 0.5\)</span>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fl">0.5</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#length of chains</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#burn-in length</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values </span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma,x0[i],n)<span class="sc">$</span>x</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics </span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum)) </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) </span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j]) </span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see Chain 2 has converged to the target in 6000
iterations.</p>
<p>for <span class="math inline">\(\sigma = 2\)</span>:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">2</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate </span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chains</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#burn-in length</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values </span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma,x0[i],n)<span class="sc">$</span>x</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics </span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum)) </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) </span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j]) </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see Chain 3 has converged to the target in 1500
iterations.</p>
<p>for <span class="math inline">\(\sigma = 16\)</span>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">16</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate </span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co">#length of chains</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co">#burn-in length</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values </span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma,x0[i],n)<span class="sc">$</span>x</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics </span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum)) </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) </span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j]) </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Chain 4 has not converged to the target and performed bad.</p>
</div>
<div id="section-16" class="section level2">
<h2>9.7</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((Xt,Yt)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = \beta_0 + \beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>From Example 9.7 (Gibbs sampler: Bivariate distribution),we can
see:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1 </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2 </span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1 </span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span> </span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span></code></pre></div>
<p>Plot the generated sample:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.09404807 0.08998493</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.8889076
## [2,] 0.8889076 1.0000000</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]), <span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see the convergence of the chain.</p>
<p>Fit a simple linear regression model <span class="math inline">\(Y =
\beta_0 + \beta_1X\)</span> to the sample and check the residuals of the
model for normality and constant variance.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>lmfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data =</span> x)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmfit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From qqplot(plot 2), we can see the residuals of the model follow the
normal distribution.From scale-location plot(plot 3), we can see the
residuals of the model has constant variance.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate </span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chains</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co">#burn-in length</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values </span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>X.GR <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>Y.GR <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0[j], x0[j]) <span class="co">#initialize</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2 </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1 </span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  X.GR[j, ] <span class="ot">&lt;-</span> X[ ,<span class="dv">1</span>]</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  Y.GR[j, ] <span class="ot">&lt;-</span> X[ ,<span class="dv">2</span>]</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics </span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X.GR, <span class="dv">1</span>, cumsum)) </span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) </span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j]) </span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y.GR, <span class="dv">1</span>, cumsum)) </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)) </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics </span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j]) </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see X,Y has converged to the target in 1000 iterations.</p>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>设置一个随机模拟研究，考虑上述三个置换检验方法的表现，考虑模型：</p>
<p><span class="math display">\[M=a_M+\alpha X+e_M\]</span></p>
<p><span class="math display">\[Y=a_Y+\beta M+\gamma X+e_Y,e_M,e_Y \sim
iid \ N(0,1)\]</span></p>
<p>关键：如何进行置换以得证1),2)或3)?</p>
<p>1)<span class="math inline">\(\alpha=0(X\bot M)\)</span> 2)<span class="math inline">\(\beta=0(M\bot Y)\)</span> 3)<span class="math inline">\(\alpha=0,\beta=0(X\bot M,M\bot Y)\)</span></p>
<p>考虑3个参数组合：</p>
<p>1)<span class="math inline">\(\alpha=0,\beta=0\)</span>,2)<span class="math inline">\(\alpha=0,\beta=1\)</span>,3)<span class="math inline">\(\alpha=1,\beta=0,\gamma=1\)</span></p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>先生成数据：</p>
<p>(1)<span class="math inline">\(X \sim
N(10,25),\alpha=0,\beta=0,\gamma=1\)</span></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>ay <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> am <span class="sc">+</span> alpha<span class="sc">*</span>X <span class="sc">+</span>em</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ay <span class="sc">+</span> beta<span class="sc">*</span>M <span class="sc">+</span>gamma<span class="sc">*</span>X <span class="sc">+</span>ey</span></code></pre></div>
<p>检验(1)(2)可以使用lmPerm包里的lmp函数。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmPerm)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;lmPerm&#39;是用R版本4.0.5 来建造的</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lmp</span>(M <span class="sc">~</span> X,<span class="at">perm=</span><span class="st">&#39;Prob&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Settings:  unique SS : numeric variables centered&quot;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lmp(formula = M ~ X, perm = &quot;Prob&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.24844 -0.67196 -0.01375  0.75539  3.64432 
## 
## Coefficients:
##   Estimate Iter Pr(Prob)
## X 0.001287   51    0.824
## 
## Residual standard error: 1.04 on 998 degrees of freedom
## Multiple R-Squared: 4.098e-05,   Adjusted R-squared: -0.000961 
## F-statistic: 0.0409 on 1 and 998 DF,  p-value: 0.8398</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lmp</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X,<span class="at">perm=</span><span class="st">&#39;Prob&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Settings:  unique SS : numeric variables centered&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lmp(formula = Y ~ M + X, perm = &quot;Prob&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.61506 -0.65643 -0.02233  0.68148  2.81319 
## 
## Coefficients:
##   Estimate Iter Pr(Prob)    
## M  0.02202  370    0.214    
## X  1.00981 5000   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.031 on 997 degrees of freedom
## Multiple R-Squared: 0.9626,  Adjusted R-squared: 0.9626 
## F-statistic: 1.284e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>由fit结果可以看出，M与X独立。由fit2结果可以看出，M与Y独立。</p>
<p>检验(3)可以使用mediation包。</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(mediation)</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#a &lt;- lm(M~X)</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#b &lt;- glm(Y~X+M)</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#result &lt;- mediate(a,b,treat=&#39;X&#39;,mediator=&#39;M&#39;,boot=T)</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(result)</span></span></code></pre></div>
<p>Prop.Mediated为中介效应占比，由上述结果看出应该没有中介效应。</p>
<p>(2)<span class="math inline">\(X \sim
N(10,25),\alpha=0,\beta=1,\gamma=1\)</span></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>ay <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> am <span class="sc">+</span> alpha<span class="sc">*</span>X <span class="sc">+</span>em</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ay <span class="sc">+</span> beta<span class="sc">*</span>M <span class="sc">+</span>gamma<span class="sc">*</span>X <span class="sc">+</span>ey</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lmp</span>(M <span class="sc">~</span> X,<span class="at">perm=</span><span class="st">&#39;Prob&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Settings:  unique SS : numeric variables centered&quot;</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lmp(formula = M ~ X, perm = &quot;Prob&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.24844 -0.67196 -0.01375  0.75539  3.64432 
## 
## Coefficients:
##   Estimate Iter Pr(Prob)
## X 0.001287   51    0.824
## 
## Residual standard error: 1.04 on 998 degrees of freedom
## Multiple R-Squared: 4.098e-05,   Adjusted R-squared: -0.000961 
## F-statistic: 0.0409 on 1 and 998 DF,  p-value: 0.8398</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lmp</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X,<span class="at">perm=</span><span class="st">&#39;Prob&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Settings:  unique SS : numeric variables centered&quot;</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lmp(formula = Y ~ M + X, perm = &quot;Prob&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.61506 -0.65643 -0.02233  0.68148  2.81319 
## 
## Coefficients:
##   Estimate Iter Pr(Prob)    
## M    1.022 5000   &lt;2e-16 ***
## X    1.010 5000   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.031 on 997 degrees of freedom
## Multiple R-Squared: 0.9641,  Adjusted R-squared: 0.9641 
## F-statistic: 1.34e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>由fit结果可以看出，M与X独立。由fit2结果可以看出，M与Y不独立。</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#result &lt;- mediate(a,b,treat=&#39;X&#39;,mediator=&#39;M&#39;,boot=T)</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(result)</span></span></code></pre></div>
<p>上述结果看出应该没有中介效应。</p>
<p>(3)<span class="math inline">\(X \sim
N(10,25),\alpha=1,\beta=0,\gamma=1\)</span></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>ay <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> am <span class="sc">+</span> alpha<span class="sc">*</span>X <span class="sc">+</span>em</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ay <span class="sc">+</span> beta<span class="sc">*</span>M <span class="sc">+</span>gamma<span class="sc">*</span>X <span class="sc">+</span>ey</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lmp</span>(M <span class="sc">~</span> X,<span class="at">perm=</span><span class="st">&#39;Prob&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Settings:  unique SS : numeric variables centered&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lmp(formula = M ~ X, perm = &quot;Prob&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.24844 -0.67196 -0.01375  0.75539  3.64432 
## 
## Coefficients:
##   Estimate Iter Pr(Prob)    
## X    1.001 5000   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.04 on 998 degrees of freedom
## Multiple R-Squared: 0.9613,  Adjusted R-squared: 0.9612 
## F-statistic: 2.477e+04 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lmp</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X,<span class="at">perm=</span><span class="st">&#39;Prob&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Settings:  unique SS : numeric variables centered&quot;</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lmp(formula = Y ~ M + X, perm = &quot;Prob&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.61506 -0.65643 -0.02233  0.68148  2.81319 
## 
## Coefficients:
##   Estimate Iter Pr(Prob)    
## M  0.02202   51        1    
## X  0.98779 5000   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.031 on 997 degrees of freedom
## Multiple R-Squared: 0.9626,  Adjusted R-squared: 0.9626 
## F-statistic: 1.284e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>由fit结果可以看出，M与X不独立。由fit2结果可以看出，M与Y独立。</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#result &lt;- mediate(a,b,treat=&#39;X&#39;,mediator=&#39;M&#39;,boot=T)</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(result)</span></span></code></pre></div>
<p>上述结果看出应该没有中介效应。</p>
<p>(4)<span class="math inline">\(X \sim
N(10,25),\alpha=1,\beta=1,\gamma=1\)</span></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>ay <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> am <span class="sc">+</span> alpha<span class="sc">*</span>X <span class="sc">+</span>em</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ay <span class="sc">+</span> beta<span class="sc">*</span>M <span class="sc">+</span>gamma<span class="sc">*</span>X <span class="sc">+</span>ey</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co">#result &lt;- mediate(a,b,treat=&#39;X&#39;,mediator=&#39;M&#39;,boot=T)</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(result)</span></span></code></pre></div>
<p>中介效应占50%。</p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>考虑模型<span class="math inline">\(P(Y=1|X_1,X_2,X_3)=expit(a+b_1X_1+b_2X_2+b_3X_3)\)</span></p>
<p><span class="math inline">\(X_1 \sim P(1),X_2 \sim Exp(1),X_3 \sim
B(1,0.5)\)</span></p>
<p>(1)写一个R函数实现上述功能，其输入值为<span class="math inline">\(N,b_1,b_2,b_3,f_0\)</span>，输出值为alpha.</p>
<p>(2)调用该函数，输入值为<span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span></p>
<p>(3)画<span class="math inline">\(f_0 \  vs \
alpha\)</span>散点图.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>findalpha <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> solution<span class="sc">$</span>root</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">findalpha</span>(<span class="at">N=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] -3.169898</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findalpha</span>(<span class="at">N=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] -6.073926</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findalpha</span>(<span class="at">N=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>## [1] -8.715275</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findalpha</span>(<span class="at">N=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.0001</span>)</span></code></pre></div>
<pre><code>## [1] -11.2702</code></pre>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.169898</span>,<span class="sc">-</span><span class="fl">6.073926</span>,<span class="sc">-</span><span class="fl">8.715275</span>,<span class="sc">-</span><span class="fl">11.2702</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0,alpha)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>设<span class="math inline">\(X_1,...,X_n \sim iid
\  Exp(\lambda)\)</span>.因为某种原因，只知道<span class="math inline">\(X_i\)</span>落在某个区间<span class="math inline">\((u_i,v_i)\)</span>,其中<span class="math inline">\(u_i &lt;
v_i\)</span>是两个非随机的已知常数，这种数据称为区间删失数据。</p>
<p>(1)试分别直接极大化观察数据的极大似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，并证明两者相等。</p>
<p>(2)设<span class="math inline">\((u_i,v_i),i=1,,,,n(=10)\)</span>的观测值为<span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\)</span>。试分别编程实现上述两种算法以得到<span class="math inline">\(\lambda\)</span>的MLE的数值解。</p>
<p>提示：观测数据的似然函数为<span class="math inline">\(L(\lambda)=
\prod ^n_{i=1} P_\lambda (u_i \leq X_i \leq v_i)\)</span></p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>max-likelihood:</p>
<p><span class="math display">\[
L(\lambda)=\prod P(u_i \leq X_i \leq v_i)
=\prod [e^{-\lambda u_i}-e^{-\lambda v_i}]
\]</span></p>
<p><span class="math display">\[
\frac{\partial lnL(\lambda)}{\partial \lambda}=\sum \frac{-u_i
e^{-\lambda u_i}+v_i e^{-\lambda v_i} }{e^{-\lambda u_i}-e^{-\lambda
v_i}}=0
\]</span></p>
<p>We can solve <span class="math inline">\(\lambda\)</span> from the
equation above.</p>
<p>EM:</p>
<p>In this question, <span class="math inline">\(u_i,v_i\)</span> is
observed data, <span class="math inline">\(X_i\)</span> is not
observed.</p>
<p>Step1:Initiate <span class="math inline">\(\lambda\)</span> with
<span class="math inline">\(\lambda_0\)</span>.</p>
<p>Step2:E-step:</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}

\ l_0(\lambda;u_i,v_i) &amp;=
E_{\lambda_0}[logL(\lambda;X_i,u_i,v_i)|u_i,v_i] \\
&amp;=E_{\lambda_0}[\sum ln(\lambda e^{-\lambda X_i}) |u_i,v_i] \\
&amp;=\sum[ln(\lambda)-\lambda E_{\lambda_0}[X_i|u_i,v_i]]

\end{split}
\end{equation*}\]</span></p>
<p><span class="math display">\[E_{\lambda_0}[X_i|u_i,v_i]=\frac{\int_{u_i}^{v_i}
x\lambda_0 e^{-\lambda_0 x}dx}{\int_{u_i}^{v_i}\lambda_0 e^{-\lambda_0
x}dx}=1/\lambda_0+\frac{u_i e^{-\lambda_0 u_i}-v_i e^{-\lambda_0 v_i}
}{e^{-\lambda_0 u_i}-e^{-\lambda_0 v_i}}\]</span></p>
<p>Step3:M-step:maximize <span class="math inline">\(l_0(\lambda;u_i,v_i)\)</span></p>
<p><span class="math display">\[\begin{equation*}
\begin{split}

\frac{\partial l_0(\lambda;u_i,v_i)}{\partial \lambda}&amp;=\sum[
1/\lambda - E_{\lambda_0}[X_i|u_i,v_i]]\\

\lambda_1 &amp;=\frac{n}{\sum E_{\lambda_0}[X_i|u_i,v_i]}

\end{split}
\end{equation*}\]</span></p>
<p>Step4:In steps 2 and 3, replace <span class="math inline">\(\lambda_0\)</span> with <span class="math inline">\(\lambda_1\)</span>, and repeat this process until
convergence (iteration).</p>
<p>Prove they are the same:</p>
<p>We can see the M-step of EM is equal to</p>
<p><span class="math display">\[
1/\lambda_1 = 1/\lambda_0+\sum\frac{u_i e^{-\lambda_0 u_i}-v_i
e^{-\lambda_0 v_i} }{e^{-\lambda_0 u_i}-e^{-\lambda_0 v_i}}/n :=
1/\lambda_0+g(\lambda_0)/n
\]</span></p>
<p>When <span class="math inline">\(\lambda_0\)</span> is getting closer
to the root of the equation in max-likelihood problem,which is equal
to</p>
<p><span class="math display">\[
g(\lambda)=0,
\]</span></p>
<p>the <span class="math inline">\(g(\lambda_0)\)</span> is getting
closer to 0, which means the process is converged.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>max-likelihood:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">+</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>root<span class="sc">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07196821</code></pre>
<p>EM:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>l0 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#let lambda0=1</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  l1 <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>l0<span class="sc">+</span>(u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>l0<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>l0<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>l0<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>l0<span class="sc">*</span>v)))</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  l0 <span class="ot">&lt;-</span> l1</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>l1</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
</div>
<div id="exercise-4" class="section level2">
<h2>2.1.3 Exercise 4</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>A list is already a vector, though not an atomic one.</p>
</div>
<div id="exercise-5" class="section level2">
<h2>2.1.3 Exercise 5</h2>
<p>Why is 1 == “1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2
false?</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>(1)1 is coerced to character “1” and “1”==“1”.</p>
<p>(2)FALSE is coerced to 0 and -1&lt;0.</p>
<p>(3)2 is coerced to character “2” and “one” comes after “2” iin
ASCII.</p>
</div>
<div id="exercise-1" class="section level2">
<h2>2.3.1 Exercise 1</h2>
<p>What does dim() return when applied to a vector?</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(a)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>dim() will return NULL when applied to a vector.</p>
</div>
<div id="exercise-2" class="section level2">
<h2>2.3.1 Exercise 2</h2>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>TRUE.</p>
</div>
<div id="exercise-1-1" class="section level2">
<h2>2.4.5 Exercise 1</h2>
<p>What attributes does a data frame possess?</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<p>names, row.names and class.</p>
</div>
<div id="exercise-2-1" class="section level2">
<h2>2.4.5 Exercise 2</h2>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<p>The type of the result of as.matrix depends on the types of the input
columns.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>df_coltypes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">c</span>(1L, 0L),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">e =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>))</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(df_coltypes)</span></code></pre></div>
<pre><code>##      a   b       c   d     e   
## [1,] &quot;a&quot; &quot;TRUE&quot;  &quot;1&quot; &quot;1.5&quot; &quot;f1&quot;
## [2,] &quot;b&quot; &quot;FALSE&quot; &quot;0&quot; &quot;2.0&quot; &quot;f2&quot;</code></pre>
<p>The method for data frames will return a character matrix if there is
only atomic columns and any non-(numeric/logical/complex) column,
applying as.vector to factors and format to other non-character columns.
Otherwise the usual coercion hierarchy (logical &lt; integer &lt; double
&lt; complex) will be used, e.g. all-logical data frames will be coerced
to a logical matrix, mixed logical-integer will give an integer matrix,
etc.</p>
</div>
<div id="exercise-3" class="section level2">
<h2>2.4.5 Exercise 3</h2>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<p>Yes.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#0x2</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">integer</span>(), <span class="at">b =</span> <span class="fu">logical</span>()) </span></code></pre></div>
<pre><code>## [1] a b
## &lt;0 行&gt; (或0-长度的row.names)</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2x0</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## data frame with 0 columns and 2 rows</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#0x0</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
</div>
<div id="exercises-2page-204-advanced-r" class="section level2">
<h2>Exercises 2(page 204, Advanced R)</h2>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<p>To apply a function to every column of a data frame, we can use
purrr::modify().</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;purrr&#39;是用R版本4.0.5 来建造的</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>data1</span></code></pre></div>
<pre><code>##   a b
## 1 1 2
## 2 2 3
## 3 3 1</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modify</span>(data1, scale01)</span></code></pre></div>
<pre><code>##     a   b
## 1 0.0 0.5
## 2 0.5 1.0
## 3 1.0 0.0</code></pre>
<p>To limit the application to numeric columns, the scoped version
modify_if() can be used.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">c=</span><span class="fu">c</span>(<span class="st">&quot;a1&quot;</span>,<span class="st">&quot;a2&quot;</span>,<span class="st">&quot;a3&quot;</span>))</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>data2</span></code></pre></div>
<pre><code>##   a b  c
## 1 1 2 a1
## 2 2 3 a2
## 3 3 1 a3</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modify_if</span>(data2, is.numeric, scale01)</span></code></pre></div>
<pre><code>##     a   b  c
## 1 0.0 0.5 a1
## 2 0.5 1.0 a2
## 3 1.0 0.0 a3</code></pre>
</div>
<div id="exercises-1page-213-advanced-r" class="section level2">
<h2>Exercises 1(page 213, Advanced R)</h2>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>data1</span></code></pre></div>
<pre><code>##   a b
## 1 1 2
## 2 2 3
## 3 3 1</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(data1,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## a b 
## 1 1</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>data2</span></code></pre></div>
<pre><code>##   a b  c
## 1 1 2 a1
## 2 2 3 a2
## 3 3 1 a3</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(data2[<span class="fu">vapply</span>(data2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## a b 
## 1 1</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9.</p>
<p>(1)Write an Rcpp function.</p>
<p>(2)Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p>
<p>(3)Compare the computation time of the two functions with the
function “microbenchmark”.</p>
</div>
<div id="answer-32" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>               <span class="co">#length of chain</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)    <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span>             <span class="co">#correlation</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>rbnR <span class="ot">&lt;-</span> <span class="cf">function</span>(N){</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)    <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">###### generate the chain #####</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)            <span class="co">#initialize</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>      x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>      m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>      X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>      x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>      m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>      X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>mat1 <span class="ot">&lt;-</span> <span class="fu">rbnR</span>(N)</span></code></pre></div>
<p>The function below is a Rcpp function:(saved in rbnC.cpp)</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>We can see they have the same distribution.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
